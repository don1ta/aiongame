<!DOCTYPE html>
<html lang="zh-Hant-TW">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="referrer" content="no-referrer">
    <title>Aion2 高階解析 - 角色名稱快速查詢版</title>
    <!-- 引入外部 CSS -->
    <link rel="stylesheet" href="css/aion.css">

    <!-- 引入共用配置與圖表庫 -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
    <script
        src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.2.0/dist/chartjs-plugin-datalabels.min.js"></script>

</head>


<body>
    <div id="loading" class="loading-overlay">⌛ 正在從伺服器獲取數據，請稍候...</div>

    <div class="container">
        <div class="input-area">
            <h2 style="color:var(--gold); margin-top:0; text-align: center;">💎 Aion2 角色數據查詢系統</h2>

            <div class="import-section">
                <div style="font-size: 14px; color: var(--gold); font-weight: bold;">🔍 方法 A：快速角色查詢</div>
                <div class="api-input-group">
                    <input type="text" id="charNameInput" placeholder="輸入角色名稱 (例如: 我愛小紅線)...">

                    <select id="serverSelect">
                        <optgroup label="─── 天族伺服器 ───">
                            <option value="尤斯迪埃">尤斯迪埃</option>
                            <option value="希埃爾">希埃爾</option>
                            <option value="奈薩肯">奈薩肯</option>
                            <option value="白傑爾">白傑爾</option>
                            <option value="凱西內爾">凱西內爾</option>
                            <option value="艾瑞爾">艾瑞爾</option>
                            <option value="普雷奇翁">普雷奇翁</option>
                            <option value="梅斯蘭泰達">梅斯蘭泰達</option>
                            <option value="希塔尼耶">希塔尼耶</option>
                            <option value="納尼亞">納尼亞</option>
                            <option value="塔哈巴達">塔哈巴達</option>
                            <option value="路特斯">路特斯</option>
                            <option value="菲爾諾斯">菲爾諾斯</option>
                            <option value="達彌努">達彌努</option>
                            <option value="卡薩卡">卡薩卡</option>
                            <option value="巴卡爾摩">巴卡爾摩</option>
                            <option value="天加隆">天加隆</option>
                            <option value="科奇隆">科奇隆</option>
                        </optgroup>
                        <optgroup label="─── 魔族伺服器 ───">
                            <option value="伊斯拉佩爾">伊斯拉佩爾</option>
                            <option value="吉凱爾">吉凱爾</option>
                            <option value="崔妮爾">崔妮爾</option>
                            <option value="露梅爾">露梅爾</option>
                            <option value="瑪爾庫坦">瑪爾庫坦</option>
                            <option value="阿斯佩爾">阿斯佩爾</option>
                            <option value="艾萊修奇卡">艾萊修奇卡</option>
                            <option value="布里特拉">布里特拉</option>
                            <option value="奈蒙">奈蒙</option>
                            <option value="哈達爾">哈達爾</option>
                            <option value="盧德萊">盧德萊</option>
                            <option value="鄔爾古倫">鄔爾古倫</option>
                            <option value="默尼">默尼</option>
                            <option value="奧達爾">奧達爾</option>
                            <option value="簡卡卡">簡卡卡</option>
                            <option value="克羅梅德">克羅梅德</option>
                            <option value="奎靈">奎靈</option>
                            <option value="巴巴隆">巴巴隆</option>
                        </optgroup>
                    </select>

                    <button class="btn-api" onclick="fetchFromApi()">立即查詢</button>
                </div>

                興趣製作非商業用途，請勿用於營利行為，資料有誤依官方為主。
            </div>
        </div>

        <div id="main-content" class="dashboard">
            <div class="header-combine-card">
                <div id="new-profile-header" class="profile-new-header" style="display:none;"></div>
                <div id="p-percentile-new" class="percentile-grid-new"></div>
            </div>

            <div class="card" style="padding: 15px 25px;">
                <div id="equipment-header" class="collapsible-header collapsed" onclick="toggleEquipmentList()"
                    style="margin-top: 0; background: transparent; border: none; padding: 0;">
                    <div style="display: flex; align-items: center; gap: 10px;">
                        <h3 style="margin: 0; border: none; padding: 0;">🛡️ 武器防具與飾品清單</h3>
                        <span id="equipment-break-badge"
                            style="background:rgba(0,212,255,0.2); color:#00d4ff; padding:4px 10px; border-radius:4px; font-size:13px; font-weight:bold; display:none;">💎
                            0件突破</span>
                        <span id="equipment-break5-badge"
                            style="background:rgba(255,215,0,0.2); color:#ffd700; padding:4px 10px; border-radius:4px; font-size:13px; font-weight:bold; display:none;">⭐
                            0件+5</span>
                    </div>
                    <div style="display: flex; align-items: center; gap: 10px;">
                        <span style="font-size: 12px; color: #8b949e;">(點擊展開/收合)</span>
                        <span id="equipment-toggle-icon" class="toggle-icon" style="transform: rotate(-90deg);">▼</span>
                    </div>
                </div>

                <div id="equipment-wrapper" class="collapsible-content collapsed" style="margin-top: 20px;">
                    <div class="section-header" id="armor-header">🛡️ 武器與防具</div>
                    <div id="equip-armor-list"></div>
                    <div class="section-header" id="accessory-header">💍 飾品與配件</div>
                    <div id="equip-accessory-list"></div>
                </div>
            </div>

            <div class="main-layout-wrapper">
                <div class="left-column">

                    <div class="stats-source-wrapper"
                        style="display:flex; gap:15px; align-items:stretch; flex-direction:column;">
                        <div class="card" style="flex:1;">

                            <div id="equip-source-grid"></div>
                            「職業不同、實戰價值」會影響評分公正性是合理的。
                        </div>


                    </div>


                    <!-- 歷史趨勢曲線圖 -->
                    <div class="card">
                        <h3>📊 歷史趨勢曲線</h3>
                        <div id="p-ranking-new" class="rank-grid-new" style="margin-top:15px;"></div>
                        <div id="trend-chart-container" style="position: relative; height: 350px; margin-top: 15px;">
                            <canvas id="trend-chart"></canvas>
                        </div>
                        <div id="trend-info"
                            style="margin-top: 15px; font-size: 13px; color: #8b949e; text-align: center;"></div>
                    </div>

                </div>
                <div class="right-column">
                    <div class="health-main-stats-wrapper" style="display:flex; gap:15px; align-items:stretch;">
                        <!-- 機體健檢報告 -->
                        <div id="health-check-card" class="card" style="display:none; flex:1; margin-top:0;"></div>

                        <!-- 主要能力值概覽 (已移動至此) -->
                        <div class="card" style="flex:1; margin-top:0;">
                            <h3>📊 主要能力值概覽</h3>
                            <div id="stat-main-grid" class="stat-grid-main"></div>
                        </div>
                    </div>

                    <!-- 戰鬥數據分析區塊 (移至下方與全寬) -->
                    <div class="card">
                        <h3>⚔️ 基礎數據分析</h3>
                        <!-- 增益效果控制面板 -->
                        <div id="gain-effect-controls"
                            style="background:rgba(255,255,255,0.03); border:1px solid rgba(255,255,255,0.05); border-radius:8px; padding:15px; margin-bottom:15px;">
                            <div style="font-size:13px; font-weight:bold; color:#bdc3c7; margin-bottom:10px;">⚙️ 增益效果
                            </div>
                            <div style="display:flex; flex-wrap:wrap; gap:15px;" id="ge-checkbox-container"></div>
                            <!-- 翅膀選擇獨立行（不影響 checkbox 排版） -->
                            <div id="wing-selection-row"
                                style="display:none; margin-top:10px; padding-top:10px; border-top:1px solid rgba(255,255,255,0.06);">
                            </div>
                        </div>
                        <div id="combat-stats-grid" class="grid-box-container"></div>
                    </div>



                    <div class="card">
                        <h3>⚔️ 技能等級分解</h3>
                        <div class="sk-label">▶ 主動技能</div>
                        <div id="sk-act" class="skill-list"></div>
                        <div class="sk-label">▶ 被動技能</div>
                        <div id="sk-pas" class="skill-list"></div>
                        <div class="sk-label">▶ 特殊/烙印技能</div>
                        <div id="sk-stigma" class="skill-list"></div>
                    </div>

                    <div class="card">
                        <h3>🎴 魔力聖物系統細項</h3>
                        <div id="arcana-grid" class="grid-box-container"
                            style="grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));"></div>
                        <h3>🔱 套裝效果全覽</h3>
                        <div id="set-bonus-grid" class="grid-box-container"
                            style="grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));"></div>
                        <h3>🐾 寵物與翅膀</h3>
                        <div id="petwing-grid" class="grid-box-container"
                            style="grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));"></div>
                    </div>
                    <h3>🎖️ 稱號系統加成細項</h3>
                    <div id="title-grid" class="title-grid"></div>

                    <h3 id="pet-insight-header" style="margin-top: 25px;">🧠 寵物洞察力</h3>
                    <div id="pet-insight-grid" class="grid-box-container"></div>
                </div>
            </div>
        </div>

    </div>

    <!-- 引入核心功能腳本 -->
    <script src="js/skill-api.js?v=99"></script>
    <script src="js/equipment-score.js?v=UI_FIX_FINAL"></script>
    <script src="js/health_check.js"></script>
    <script src="js/aion.js"></script>
</body>

</html>