# 裝備等級成長曲線功能說明

## 功能概述
新增了「📈 裝備等級成長曲線」區塊,顯示角色道具等級的歷史成長趨勢。

## 功能特點

### 1. 時間序列曲線圖
- 使用 Chart.js 繪製折線圖
- 顯示道具等級隨時間的變化趨勢
- 最新資料點使用**金色**標記,歷史資料使用**藍色**
- 平滑的曲線連接,帶有漸層填充效果

### 2. 統計資訊
圖表下方顯示以下統計數據:
- **目前等級**: 最新的道具等級
- **總成長**: 從第一筆記錄到現在的總成長值和成長率
- **最高紀錄**: 歷史最高道具等級
- **追蹤天數**: 從第一筆記錄到最新記錄的天數

### 3. 互動功能
- 滑鼠懸停在資料點上可查看詳細資訊:
  - 完整日期 (年/月/日)
  - 道具等級
  - 模式類型 (PVE/PVP/ALL)
  - 與前一次記錄的變化量

## 資料來源

### API 回傳的 itemLevelHistory 格式
```json
{
  "itemLevelHistory": [
    {
      "date": "2025-12-28T16:00:00.000Z",
      "modelType": "ALL",
      "itemLevel": 2790
    },
    {
      "date": "2026-01-06T16:00:00.000Z",
      "modelType": "PVE",
      "itemLevel": 2871
    }
    // ... 更多歷史記錄
  ]
}
```

### 資料位置
函數會自動從以下位置尋找資料:
1. `data.itemLevelHistory`
2. `data.queryResult.itemLevelHistory`

## 使用方式

1. 在首頁輸入角色名稱和選擇伺服器
2. 點擊「立即查詢」按鈕
3. 等待資料載入完成
4. 向下滾動到「📈 裝備等級成長曲線」區塊
5. 查看成長曲線和統計資訊

## 技術實作

### 檔案修改
- **檔案**: `aion.html`
- **修改位置**:
  1. HTML 區塊 (第 1455-1463 行): 圖表容器
  2. JavaScript 函數 (第 2661-2835 行): `renderItemLevelChart()` 函數
  3. 函數調用 (第 2644 行): 在 `processData()` 中調用

### 圖表類型
- **類型**: 折線圖 (line chart)
- **特效**: 
  - 平滑曲線 (tension: 0.3)
  - 漸層填充
  - 動態資料點顏色
  - 懸停放大效果

### 依賴項
- Chart.js 4.4.1 (已在第 10 行引入)

## 顯示邏輯

### 日期格式化
- X 軸標籤: `月/日` (例如: 1/6)
- Tooltip 標題: `年/月/日` (例如: 2026/1/6)

### 顏色配置
- **曲線**: 藍色 `rgba(0, 212, 255, 1)`
- **填充**: 淡藍色 `rgba(0, 212, 255, 0.1)`
- **歷史資料點**: 藍色 `rgba(0, 212, 255, 0.6)`
- **最新資料點**: 金色 `rgba(255, 217, 61, 0.8)`

## 錯誤處理

1. **無歷史資料**: 顯示「⚠️ 無歷史等級資料」
2. **資料為空陣列**: 清除畫布並顯示提示訊息
3. **找不到資料**: 自動嘗試從多個可能位置讀取

## 計算說明

### 總成長
```javascript
總成長 = 目前等級 - 起始等級
```

### 成長率
```javascript
成長率 = (總成長 / 起始等級) × 100%
```

### 追蹤天數
```javascript
追蹤天數 = (最新日期 - 起始日期) / (1000 × 60 × 60 × 24)
```

## 注意事項

1. 圖表會在每次查詢時自動更新
2. 舊的圖表實例會被自動銷毀,避免記憶體洩漏
3. Y 軸不從 0 開始,以更清楚顯示等級變化
4. 日期標籤會旋轉 45 度以避免重疊

## 範例資料解讀

假設有以下資料:
- 起始等級: 2790 (2025/12/28)
- 目前等級: 3101 (2026/2/8)
- 最高紀錄: 3103
- 追蹤天數: 42 天

則顯示:
- **總成長**: +311 (11.15%)
- **最高紀錄**: 3103
- **追蹤天數**: 42 天

## 未來改進建議

1. 新增平均成長速度計算
2. 支援選擇日期範圍
3. 新增成長趨勢預測
4. 支援匯出圖表為圖片
5. 新增與其他玩家的比較功能
